<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
	<meta name="generator" content="Hugo 0.18" />
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>More than seven &middot; More than seven</title>

  
  <link rel="stylesheet" href="/css/poole.css">
  <link rel="stylesheet" href="/css/hyde.css">
  <link rel="stylesheet" href="/css/poole-overrides.css">
  <link rel="stylesheet" href="/css/hyde-overrides.css">
  <link rel="stylesheet" href="/css/hyde-x.css">
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/touch-icon-144-precomposed.png">
  <link href="/favicon.png" rel="icon">

  
  
  
  <link href="/index.xml" rel="alternate" type="application/rss+xml" title="More than seven &middot; More than seven" />

  <meta name="description" content="">
  <meta name="keywords" content="">
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-435455-1', 'auto');
    ga('send', 'pageview');
  </script>
  
</head>
<body class="theme-base-08">
<div class="sidebar">
  <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=morethansevennet" id="_carbonads_js"></script>
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      
      <h1><a href="/">More than seven</a></h1>
      <p class="lead">Writing about code. Occasional other topics. Made by <a href="https://twitter.com/garethr">@garethr</a>.</p>
    </div>
  </div>
</div>


<div class="content container">
  <div class="posts">
    
    
    <div class="post">
      <h1 class="post-title">
        <a href="/2009/02/10/append-slashes-urls-django/">Append slashes to URLs in Django</a>
      </h1>
      <span class="post-date">Feb 10, 2009 &middot; 2 minute read
      </span>
      
      <p>Quick Django pop quiz. Can anyone spot the deliberate mistake in the following url definition? We&rsquo;re trying to define a view called log_viewer and instructing a specific url pattern to render it.</p>

<p>pre. urlpatterns = patterns(&ldquo;,
(r&rsquo;^log/?$&lsquo;, log_viewer),
)</p>

<p>In this case our regex matches /log or /log/ using the /? optional pattern. This is because even if we only link to one format we know people will probably visit both, either by entering the URL manually or by linking from an external source.</p>

<p>As far as HTTP is concerned though /log and /log/ are separate URLs, even if they display the same content. The main reason this matters for public facing websites is that our friendly search engine spiders are likely to index both separately, leading to splitting the page rank as well as accusations of duplicate content which might see further erosion of rankings.</p>

<p>The solution is generally to issue a 301 redirect from one format to the other. This tells search engines and people alike that the canonical location for the requested content is elsewhere. You could specify the redirect manually, but this is going to get irritating quickly once you have a few more definitions.</p>

<p>pre. urlpatterns = patterns(&ldquo;,
(r&rsquo;^log$&lsquo;, redirect_to, {&lsquo;url&rsquo;: &lsquo;/log/&rsquo;}),
(r&rsquo;^log/$&lsquo;, log_viewer),
)</p>

<p>Handily Django provides a mechanism to do exactly what we want to do by setting <a href="http://docs.djangoproject.com/en/dev/ref/settings/#append-slash">APPEND_SLASH</a> to True in your settings file. Even better it&rsquo;s switched on by default. So if you don&rsquo;t know much about the intricacies of HTTP you still get the correct behavior. That is unless you specify your URL patterns in the format above.</p>

<p>You see APPEND_SLASH only works if the URL doesn&rsquo;t match a specified pattern. If no pattern match is found it appends a trailing slash and checks for a match again. Because the above pattern matches the pattern without the trailing slash (/log) the desired behavior is never triggered, and the view is rendered at both URLs. So although we want to catch /log and /log/ on the front end, our urls.py definition should actually be:</p>

<p>pre. urlpatterns = patterns(&ldquo;,
(r&rsquo;^log/$&lsquo;, log_viewer),
)</p>

<p>Django has lots of useful bits of magic for doing the right thing, but unless you know what they <em>actually</em> do you either end up recreating functionality yourself, or find features don&rsquo;t work in quite the way you thought. It&rsquo;s a good argument for keeping frameworks small whenever possible, and for developers to at least know their way around the code of their respective framework.</p>

      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="/2009/02/07/new-version-radiant-cms-out-today/">New Version of Radiant CMS Out Today</a>
      </h1>
      <span class="post-date">Feb 7, 2009 &middot; 1 minute read
      </span>
      
      <p>Via <a href="http://github.com/radiant/radiant/tree/master">tagging a new release</a> on GitHub I see a new version of <a href="http://radiantcms.org/">Radiant</a> (0.7) has been released. Radiant is a really nice CMS for smaller projects, it&rsquo;s used on the official <a href="http://www.ruby-lang.org/">Ruby</a> site and I used it here at one point.</p>

<p>Go check out the <a href="http://radiantcms.org/blog/archives/2009/02/07/radiant-0-7-0---intaglio-release-final/">blog post for the full list of the changes</a>.</p>

      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="/2009/02/07/pdb-and-appengine/">PDB and AppEngine</a>
      </h1>
      <span class="post-date">Feb 7, 2009 &middot; 1 minute read
      </span>
      
      <p>It turns out App Engine breaks the default behaviour of the Python debugger PDB by sending STDOUT to the browser. But with a <a href="http://jjinux.blogspot.com/2008/05/python-debugging-google-app-engine-apps.html">little bit of python</a> you can put it back in.</p>

<p>pre. import sys
import pdb
for attr in (&lsquo;stdin&rsquo;, &lsquo;stdout&rsquo;, &lsquo;stderr&rsquo;):
setattr(sys, attr, getattr(sys, &lsquo;<strong>s</strong>&rsquo; attr))
pdb.set_trace()</p>

      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="/2009/02/07/xmpp-and-offline-processing-coming-google-app-engi/">XMPP and offline processing coming to Google App Engine</a>
      </h1>
      <span class="post-date">Feb 7, 2009 &middot; 1 minute read
      </span>
      
      <p>Three weeks ago I pondered whether <a href="http://morethanseven.net/2009/01/15/are-xmpp-and-offline-processing-coming-google-app-/">XMPP and offline processing were coming to Google App Engine?</a>. It was a hunch based on the upcoming release of Jaiku on App Engine. I reasoned you couldn&rsquo;t really do it without XMPP and offline processing APIs. Looks like I was right.</p>

<p>Today <a href="http://bitworking.org/news/">Joe Gregorio</a> announced on the <a href="http://googleappengine.blogspot.com/">App Engine Blog</a> an <a href="http://googleappengine.blogspot.com/2009/02/roadmap-update.html">update to the roadmap for the next 6 months</a>; including</p>

<ul>
<li>Support for running scheduled tasks</li>
<li>Task queues for performing background processing</li>
<li>Ability to receive and process incoming email</li>
<li>Support for sending and receiving XMPP (Jabber) messages</li>
</ul>

<p>Colour me excited. This could be the point were we start seeing more and more interesting IM interfaces. And this ticks off several of my must haves for App Engine.</p>

      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="/2009/02/05/hosting-images-app-engine/">Hosting Images on App Engine</a>
      </h1>
      <span class="post-date">Feb 5, 2009 &middot; 3 minute read
      </span>
      
      <p>I like adding images to the occasional blog post but don&rsquo;t do it as often as I want to. The reason being I can hardly ever be bothered to resize images. It means opening up a memory hogging application, fiddling around for a few minutes and then saving it out somewhere, then uploading said image to my server. All of those things bore me.</p>

<p>Appengine to the rescue. As an excuse to play around with the <a href="http://code.google.com/appengine/docs/python/images/overview.html">image API</a> as well as add more pictures to this here blog I decided to build myself a small image hosting application. I really only care about the two things noted above; resizing and uploading. If I can do that in one go I&rsquo;m happy.</p>

<p>A couple of train rides (all the best code gets written on train journeys, fact) later and I&rsquo;ve deployed the first version of Image Host which looks a little something like this:</p>

<p><img src="http://image-host.appspot.com/i/img?id=agppbWFnZS1ob3N0cgwLEgVJbWFnZRjtBww" alt="Image Hosting interface on Google App Engine"/></p>

<p>(And yes that image is an image of image-host hosted on image-host. If you&rsquo;re thinking <em>what image?</em> then it means this experiment isn&rsquo;t working at the moment.)</p>

<p>The application is designed in such a way as you could have as many people uploading and managing their own set of images as you want, all within one instance. The only reason I don&rsquo;t just open it up to any google user account is that it would eat into my quotas if it got popular and I have no interest in policing whatever dubious images anyone might upload.</p>

<p>I&rsquo;ve been playing with App Engine quite extensively of late. I really appreciate the SDK and the limited, but well designed and thought out APIs and testing stubs. At the moment I&rsquo;m happy with where it&rsquo;s at. It&rsquo;s obviously early days but in my mind all I really want are APIs for offline processing, some sort of message queuing facility, XMPP support and a payment model for raising the limitations. And several of those are already slated for the near future.</p>

<p>If anyone wants to host their own version you can grab the code from <a href="http://github.com/garethr/appengine-image-host/tree/master">GtHub</a>. You&rsquo;ll need your own App Engine account and your own snappy name but that&rsquo;s all. If you really don&rsquo;t want to do that, have a good reason to needing image hosting and ask nicely I might add more people to my version as well.</p>

<p>Their are a few bugs I&rsquo;m going to fix when I get a moment, a few documented limitations I know about and I&rsquo;m still fleshing out the test suite to cover all the functionality. But all in all a worthwhile few hours spent hacking. I&rsquo;ll probably get round to writing up some pointers for testing App Engine code as well as their are a host of gotchas and the only real documentation at present is comments in the code.</p>

      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="/2009/02/02/pep-374/">PEP 374</a>
      </h1>
      <span class="post-date">Feb 2, 2009 &middot; 1 minute read
      </span>
      
      <p>The Python core developers are currently <a href="http://www.python.org/dev/peps/pep-0374/">discussing whether to move away from SVN to a distributed version control system</a>. It&rsquo;s a worthwhile read for anyone involved in this sort of decision in any capacity. It features hands on examples of each of the contenders (Bazaar, Git and Mercurial), some interesting observations about all of them as well as some benchmarks against a mature codebase. Lots of conversations keep cropping up on Twitter about why bother switching to Git or other distributed systems - this is a good place to start whether you use Python or not.</p>

      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="/2009/02/01/sinatra-simple-example/">Sinatra Simple Example</a>
      </h1>
      <span class="post-date">Feb 1, 2009 &middot; 3 minute read
      </span>
      
      <p>I&rsquo;ve been playing around with the <a href="http://www.sinatrarb.com/">Sinarta</a> Ruby web development framework recently and building a <a href="http://github.com/garethr/sinatra-hello-world">larger than usual Hello World Example</a>. It&rsquo;s describes itself as <em>a DSL for quickly creating web-applications in Ruby with minimal effort</em> (what is it about Ruby people and their obsession with calling everything a DSL?). In reality it&rsquo;s a great little web framework. It deals with a minimal set of the things you really need to do as part of any application - URL handling and routing, HTTP request and response handling, etc. It reminds me of <a href="http://webpy.org/">web.py</a> in it&rsquo;s minimalist approach which is definitely a good thing.</p>

<p>The following example is the hello world given on the site</p>

<p>pre. require &lsquo;rubygems&rsquo;
require &lsquo;sinatra&rsquo;
get &lsquo;/&rsquo; do
&lsquo;Hello world!&rsquo;
end</p>

<p>Which isn&rsquo;t a million miles away from a web.py example:</p>

<p>pre. import web
urls = (
&lsquo;/&rsquo;, &lsquo;hello&rsquo;
)
app = web.application(urls, globals())
class hello:
def GET (self, name):
return &lsquo;Hello World&rsquo;
if <em>name</em> == &ldquo;<em>main</em>&ldquo;:
app.run()</p>

<p>The only real difference is the separate mapping of URLs to views in web.py, which is closer to how Rails or Django do things.</p>

<p>Their is quite a bit of <a href="http://www.sinatrarb.com/documentation.html">documentation</a> already for Sinatra, including the start of a <a href="http://www.sinatrarb.com/book.html">book</a>. The code (as with all good code these days) is on <a href="http://github.com/sinatra/sinatra/tree/master">github</a> for your forking pleasure.</p>

<p>As for what I&rsquo;ve been up to I have a more advanced <a href="http://github.com/garethr/sinatra-hello-world">Hello World</a> example up on GitHub. I&rsquo;m wanting to get a running application that demonstrates all the basic features (except <a href="http://morethanseven.net/2008/04/11/dsls-for-html-and-css-the-future-or-just-plain-wro/">HAML and SASS</a> support). So far I&rsquo;ve got a simple bit of Rack middleware, several views demonstrating different url handling techniques, basic erb templates, before methods, configuration settings, error handling, decent unit test coverage, a rake file with a tasks for documentation, code coverage, etc. I&rsquo;ve also got configuration files for running the application with <a href="http://code.macournoyer.com/thin/">Thin</a> and using <a href="http://god.rubyforge.org/">God</a>. I&rsquo;m going to add some simple database connectivity in at some point (either <a href="http://datamapper.org">DataMapper</a> or <a href="http://sequel.rubyforge.org/">Sequel</a>, I haven&rsquo;t decided yet) and play around with writing spec tests and a capistrano recipe file. All in it&rsquo;s a nice way of learning something new at the same time as producing something that might be useful. Once I have the rest of the bits and pieces I might even right a full tutorial.</p>

<p>I think the sweet spot for these sorts of mini frameworks are small services or little applications that just sit their are run. Both <a href="http://integrityapp.com/">Integrity</a> and <a href="http://irclogger.com">IRCLogger</a> both use Sinatra for instance and I think it&rsquo;s used for the <a href="http://github.com/guides/post-receive-hooks">GitHub WebHooks</a> as well. It&rsquo;s exactly the sort of thing Google AppEngine is useful for in fact and Sinatra would likely be a closer fit that Rails if Google ever feel like adding Ruby support. Although it does depress me a little that the <a href="http://code.google.com/p/googleappengine/issues/list">top four items in the public issue tracker</a> are <em>I want my own language</em>.</p>

      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="/2009/01/29/jsonpickle/">Jsonpickle</a>
      </h1>
      <span class="post-date">Jan 29, 2009 &middot; 1 minute read
      </span>
      
      <p><a href="http://code.google.com/p/jsonpickle">Jsonpickle</a> is a Python library for serializing any arbitrary object graph into JSON. The advantage over something like simplejson is the <em>arbitrary</em> part, simplejson throws errors when you try and serialize some types of objects. I also prefer the jsonpickle API (encode, decode) over simplejson (dump, dumps, load, loads).</p>

      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="/2009/01/28/git-issue-tracking/">Git Issue Tracking</a>
      </h1>
      <span class="post-date">Jan 28, 2009 &middot; 1 minute read
      </span>
      
      

<p><a href="http://wiki.github.com/schacon/ticgit">TicGit</a> looks great. I love command line apps and have been looking for something like this for a while. It&rsquo;s described as a:</p>

<blockquote>
<p>Git based distributed ticketing system, including a command line client and web viewer</p>
</blockquote>

<p>pre. #&gt;ti list</p>

<h2 id="ticid-title-state-date-assgn-tags"># TicId Title State Date Assgn Tags</h2>

<ul>
<li>1 9ebd07 add attachment to ticket open 03/22 schacon attach,feature
2 6ca8be download attached file open 03/22 schacon attach,feature
3 bec8e9 add a milestone resol 03/22 schacon feature,milestone,ne
4 9b83ea general tag management open 03/22 schacon feature,tags
5 94f24e show expanded comments open 03/22 schacon feature,ticket
6 f3dd9b remove a ticket open 03/22 schacon feature,ticket
7 e1629e improved cli support open 03/22 schacon cli,feature</li>
</ul>

<p>Perfect for my pet projects or working with like minded folk.</p>

      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="/2009/01/24/defence-apache-ant/">In Defence of Apache Ant</a>
      </h1>
      <span class="post-date">Jan 24, 2009 &middot; 3 minute read
      </span>
      
      <p>I&rsquo;m a big fan of the <a href="http://ant.apache.org/">Ant</a> build tool. Their I said it. Nearly everyone else I end up talking to about build scripts (more people that you&rsquo;d think, but OK, it&rsquo;s hardly the most exciting topic of conversation) either hates it or treats it with disdain.</p>

<p>I&rsquo;ve been using it for a few years on and off, in several jobs and for personal projects as well. I&rsquo;ve used it while writing Python, .NET and PHP. It might be somewhat unfashionable (it&rsquo;s written in Java and you write your commands in XML) but, for me at least, it&rsquo;s incredibly handy to have around.</p>

<p>Ant is a build tool. It lets you define tasks in a config file (called build.xml) and then execute them via running the <em>ant</em> command line application. It supports dependencies between tasks as well as defining properties that can be used by multiple tasks. It supports a lot of Java specific stuff as well but also has the ability to simply execute commands on the host OS.</p>

<p>As a really simple example of a few tasks I use on more than one project involve simple backups and deployment.</p>

<p>First I set up a few properties including details of where my site files live and the SSH access details for the remote site.</p>

<p>pre. <property name="username" value=""/>
<property name="host" value=""/>
<property name="dir" value=""/></p>

<p>The first example task simply runs a backup of everything in the target directory using scp.</p>

<p>pre. <target name="backup" description="backup site" >
<exec executable="scp" dir="." failonerror="true">
<arg value="-r"/>
<arg value="${username}@${host}:${dir}"/>
<arg value="backups/${TODAY_UK}"/>
</exec>
</target></p>

<p>If I make local changes and want to push them to the live site I have another simple task which shells out to rsync.</p>

<p>pre. <target name="deploy" description="deploy usng rsync" >
<exec executable="rsync" dir="." failonerror="true">
<arg value="-r"/>
<arg value="."/>
<arg value="${username}@${host}:${dir}"/>
<arg value="--exclude-from=rsync.excludes"/>
<arg value="-v"/>
</exec>
</target></p>

<p>I know <a href="http://simonwillison.net">some people</a> hate this separate arguments as individual elements. Yes it&rsquo;s excessively XML but it makes everything incredibly clear to anyone who might sneak a look. And build scripts change little compared to project code so the verbosity never bothers me overly. If you really want you can put everything on one line, but I find that harder to follow and maintain.</p>

<p>pre. <target name="deploy" description="deploy usng rsync" >
<exec executable="rsync" dir="." failonerror="true">
<arg line="-r . "${username}@${host}:${dir} --exclude-from=rsync.excludes -v"/>
</exec>
</target></p>

<p>For bigger projects I tend to create more complex backup and deployment tasks, or more often than not add in various dependencies. But you hopefully get the idea. Even for simple commands like this that would be a single line bash script I tend to use ant. I find by putting things together into a build script I&rsquo;m more likely to add useful functionality to it later, and to remember and therefore run the commands more often.</p>

<p>A good reference for finding out more than is in the <a href="http://ant.apache.org/manual/index.html">manual</a> is the <a href="http://wiki.apache.org/ant/FrontPage">Apache Ant Wiki</a>. More than anything it features real examples that you can learn from which with Ant is definitely the best way to discover new tricks.</p>

<p>I know their are a number of other tools in languages I like more. On occasion I use <a href="http://rake.rubyforge.org/">Rake</a>, <a href="http://savannah.nongnu.org/projects/fab">Fabric</a> and <a href="http://www.capify.org/">Capistrano</a>. I&rsquo;ve looked at <a href="http://www.zedshaw.com/projects/vellum/">Vellum</a> and good old make. I know others who swear by just writing simple bash scripts or using straight Ruby, PHP or Python (or not writing build scripts at all and doing everything by hand. But I like having my build scripts separate and simple. It might not be pretty or fashionable, but Ant does almost perfectly what I want it to do.</p>

      
    </div>
    
    
    
    <ul class="pagination">
        
        <li>
            <a href="/" aria-label="First"><span aria-hidden="true">&laquo;&laquo;</span></a>
        </li>
        
        <li
        >
        <a href="/page/17/" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
        </li>
        
        <li
        ><a href="/">1</a></li>
        
        <li
        ><a href="/page/2/">2</a></li>
        
        <li
        ><a href="/page/3/">3</a></li>
        
        <li
        ><a href="/page/4/">4</a></li>
        
        <li
        ><a href="/page/5/">5</a></li>
        
        <li
        ><a href="/page/6/">6</a></li>
        
        <li
        ><a href="/page/7/">7</a></li>
        
        <li
        ><a href="/page/8/">8</a></li>
        
        <li
        ><a href="/page/9/">9</a></li>
        
        <li
        ><a href="/page/10/">10</a></li>
        
        <li
        ><a href="/page/11/">11</a></li>
        
        <li
        ><a href="/page/12/">12</a></li>
        
        <li
        ><a href="/page/13/">13</a></li>
        
        <li
        ><a href="/page/14/">14</a></li>
        
        <li
        ><a href="/page/15/">15</a></li>
        
        <li
        ><a href="/page/16/">16</a></li>
        
        <li
        ><a href="/page/17/">17</a></li>
        
        <li
        class="active"><a href="/page/18/">18</a></li>
        
        <li
        ><a href="/page/19/">19</a></li>
        
        <li
        ><a href="/page/20/">20</a></li>
        
        <li
        ><a href="/page/21/">21</a></li>
        
        <li
        ><a href="/page/22/">22</a></li>
        
        <li
        ><a href="/page/23/">23</a></li>
        
        <li
        ><a href="/page/24/">24</a></li>
        
        <li
        ><a href="/page/25/">25</a></li>
        
        <li
        ><a href="/page/26/">26</a></li>
        
        <li
        ><a href="/page/27/">27</a></li>
        
        <li
        ><a href="/page/28/">28</a></li>
        
        <li
        ><a href="/page/29/">29</a></li>
        
        <li
        ><a href="/page/30/">30</a></li>
        
        <li
        ><a href="/page/31/">31</a></li>
        
        <li
        ><a href="/page/32/">32</a></li>
        
        <li
        ><a href="/page/33/">33</a></li>
        
        <li
        ><a href="/page/34/">34</a></li>
        
        <li
        ><a href="/page/35/">35</a></li>
        
        <li
        ><a href="/page/36/">36</a></li>
        
        <li
        ><a href="/page/37/">37</a></li>
        
        <li
        ><a href="/page/38/">38</a></li>
        
        <li
        ><a href="/page/39/">39</a></li>
        
        <li
        ><a href="/page/40/">40</a></li>
        
        <li
        ><a href="/page/41/">41</a></li>
        
        <li
        ><a href="/page/42/">42</a></li>
        
        <li
        >
        <a href="/page/19/" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
        </li>
        
        <li>
            <a href="/page/42/" aria-label="Last"><span aria-hidden="true">&raquo;&raquo;</span></a>
        </li>
        
    </ul>
    
  </div>
</div>



</body>
</html>

